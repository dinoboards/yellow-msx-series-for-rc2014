

PROBE_HARDWARE:
	; LD	(RS_FCB), HL

	; LD	DE, MSG.CPU_SPEED
	; CALL	PRINT

	; LD	DE, MSG.MEMORY
	; CALL	PRINT

	; LD	DE, MSG.VIDEO
	; CALL	PRINT

	LD	DE, MSG.SIO
	CALL	PRINT

	CALL	SIO_PROBE
	JR	Z, SIO_FOUND

	LD	DE, MSG.NOT
	CALL	PRINT

SIO_FOUND:
	LD	DE, MSG.PRESENT
	CALL	PRINT

	LD	DE, MSG.RTC
	CALL	PRINT

	CALL	RP5RTC_PROBE
	JR	Z, RTC_FOUND

	LD	DE, MSG.NOT
	CALL	PRINT

RTC_FOUND:
	LD	DE, MSG.PRESENT
	CALL	PRINT

	; LD	DE, MSG.RTC
	; CALL	PRINT

	; LD	DE, MSG.GAME
	; CALL	PRINT

	; LD	DE, MSG.KEYBOARD
	; CALL	PRINT

	; LD	HL, 6
	; CALL	ALLOC

	RET

MSG.SIO
	DB	"SIO/2 Module:        ", 9, 0

MSG.CPU_SPEED
	DB	"CPU:                 ", 9, "7Mhz", 13, 10, 0

MSG.MEMORY
	DB	"Memory Module:       ", 9, "512K, 1024K", 13, 10, 0

MSG.RTC
	DB	"RTC/F4 Module:       ", 9, 0

MSG.GAME
	DB	"Game Module:         ", 9, "PRESENT", 13, 10, 0

MSG.VIDEO
	DB	"Video Module:        ", 9, "V9958", 13, 10, 0

MSG.KEYBOARD
	DB	"PPI/Keyboard Module: ", 9, "PRESENT", 13, 10, 0

MSG.PRESENT
	DB	"PRESENT", 13, 10, 0

MSG.NOT
	DB	"NOT ", 0


; DETECT RTC HARDWARE PRESENCE
; RTC HARDWARE IS NORMALL MANAGED BY THE BIOS
; SO WE ONLY NEED TO TEST IF PRESENT.
;
RP5RTC_PROBE:
	LD	C, 00100000b
	LD	IX, REDCLK
	CALL	CALSUB
	AND	0Fh
	CP	0Ah
	RET
