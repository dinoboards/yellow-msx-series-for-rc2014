
SIO0BASE	EQU	$80		; SIO BASE PORT
SIO0A_DAT	EQU	SIO0BASE + 1	; DATA PORT
SIO0A_CMD	EQU	SIO0BASE + 0	; CONTROL/STATUS PORT

SIO0B_CMD	EQU	SIO0BASE + 2	; DATA PORT
SIO0B_DAT	EQU	SIO0BASE + 3    ; CONTROL/STATUS PORT

DAT_CH	EQU	SIO0B_DAT
CMD_CH	EQU	SIO0B_CMD


SIO_WR1VAL	EQU	$18		; WR1 VALUE FOR INT ON RECEIVED CHARS
SIO_RTSON	EQU	$EA
SIO_RTSOFF	EQU	$E8
SIO_BUFSZ	EQU	245
SIO_BUF_HI	EQU	132

SIO_INIT	MACRO	CMD, RTS
	; WR0: CHANNEL RESET CMD
	LD	A, 0
	OUT	(CMD), A
	LD	A, 018H
	OUT	(CMD), A

	; WR4: CLK BAUD PARITY STOP BIT
	LD	A, 4
	OUT	(CMD), A
	LD	A, 001000100B	; CLK DIV 16
	OUT	(CMD), A

	; WR1: INTERRUPT ON
	LD	A, 1
	OUT	(CMD), A
	LD	A, SIO_WR1VAL
	OUT	(CMD), A

	; WR2: IM2 VEC OFFSET
	LD	A, 2
	OUT	(CMD), A
	LD	A, 00H
	OUT	(CMD),A

	; WR3: 8 BIT RCV, CTS/DCD AUTO, RX ENABLE
	LD	A, 3
	OUT	(CMD), A
	LD	A, 0E1H
	OUT	(CMD), A

	; WR5: DTR, 8
	LD	A, 5
	OUT	(CMD), A
	LD	A, RTS
	OUT	(CMD), A
	ENDM

DISABLE_SIO_INTERRUPTS		MACRO
	LD	A, 1
	OUT	(SIO0A_CMD), A
	LD	A, 0
	OUT	(SIO0A_CMD),A

	LD	A, 1
	OUT	(SIO0B_CMD), A
	LD	A, 0
	OUT	(SIO0B_CMD),A

	ENDM
